<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema Marques Algodoeiro</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }

    header {
      background: #2c3e50;
      color: #fff;
      padding: 15px;
      text-align: center;
    }

    nav {
      display: flex;
      justify-content: center;
      background: #34495e;
      flex-wrap: wrap;
    }

    nav button {
      background: none;
      border: none;
      color: #fff;
      padding: 14px 20px;
      cursor: pointer;
      font-size: 16px;
    }

    nav button:hover,
    nav button.active {
      background: #1abc9c;
    }

    .tab-content {
      display: none;
      padding: 20px;
      background: #fff;
      margin: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .tab-content.active {
      display: block;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 400px;
    }

    input, select, button[type="submit"] {
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    button[type="submit"] {
      background: #1abc9c;
      color: #fff;
      border: none;
      cursor: pointer;
    }

    button[type="submit"]:hover {
      background: #16a085;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    table th, table td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
    }

    table th {
      background: #1abc9c;
      color: #fff;
    }

    .btn-excluir {
      background: #e74c3c;
      color: #fff;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn-excluir:hover {
      background: #c0392b;
    }
  </style>
</head>
<body>
  <header>
    <h1>Sistema Marques Algodoeiro</h1>
  </header>

  <nav>
    <button class="tab-link active" data-tab="tab1">Registrar Nova Correspondência</button>
    <button class="tab-link" data-tab="tab2">Histórico de Entregas</button>
    <button class="tab-link" data-tab="tab3">Cadastrar Novo Morador</button>
  </nav>

  <main>
    <!-- Aba 1 -->
    <section id="tab1" class="tab-content active">
      <h2>Registrar Nova Correspondência</h2>
      <form id="form-correspondencia">
        <input type="text" id="nomeMorador" placeholder="Nome do Morador" required>
        <select id="tipoCorrespondencia" required>
          <option value="">Selecione o tipo</option>
          <option value="Carta">Carta</option>
          <option value="Encomenda">Encomenda</option>
          <option value="Outros">Outros</option>
        </select>
        <input type="date" id="dataRecebimento" required>
        <button type="submit">Registrar</button>
      </form>
    </section>

    <!-- Aba 2 -->
    <section id="tab2" class="tab-content">
      <h2>Histórico de Entregas</h2>
      <table id="tabela-entregas">
        <thead>
          <tr>
            <th>Morador</th>
            <th>Tipo</th>
            <th>Data</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <!-- Linhas adicionadas via JS -->
        </tbody>
      </table>
    </section>

    <!-- Aba 3 -->
    <section id="tab3" class="tab-content">
      <h2>Cadastrar Novo Morador</h2>
      <form id="form-morador">
        <input type="text" id="novoMorador" placeholder="Nome do Morador" required>
        <input type="text" id="apartamento" placeholder="Apartamento" required>
        <button type="submit">Cadastrar</button>
      </form>

      <h3>Moradores Cadastrados</h3>
      <ul id="lista-moradores"></ul>
    </section>
  </main>

  <script>
    // ---------- Controle das abas ----------
    const tabLinks = document.querySelectorAll('.tab-link');
    const tabContents = document.querySelectorAll('.tab-content');

    tabLinks.forEach(button => {
      button.addEventListener('click', () => {
        tabLinks.forEach(btn => btn.classList.remove('active'));
        tabContents.forEach(tab => tab.classList.remove('active'));

        button.classList.add('active');
        const target = button.getAttribute('data-tab');
        document.getElementById(target).classList.add('active');
      });
    });

    // ---------- Funções de LocalStorage ----------
    function salvarDados(chave, dados) {
      localStorage.setItem(chave, JSON.stringify(dados));
    }

    function carregarDados(chave) {
      return JSON.parse(localStorage.getItem(chave)) || [];
    }

    // ---------- Histórico de entregas ----------
    const formCorrespondencia = document.getElementById('form-correspondencia');
    const tabelaEntregas = document.querySelector('#tabela-entregas tbody');
    let entregas = carregarDados("entregas");

    function atualizarTabela() {
      tabelaEntregas.innerHTML = "";
      entregas.forEach((e, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${e.nome}</td>
          <td>${e.tipo}</td>
          <td>${e.data}</td>
          <td><button class="btn-excluir" onclick="excluirEntrega(${index})">Excluir</button></td>
        `;
        tabelaEntregas.appendChild(row);
      });
    }

    function excluirEntrega(index) {
      if (confirm("Deseja realmente excluir esta entrega?")) {
        entregas.splice(index, 1);
        salvarDados("entregas", entregas);
        atualizarTabela();
      }
    }

    atualizarTabela();

    formCorrespondencia.addEventListener('submit', function(e) {
      e.preventDefault();
      const nome = document.getElementById('nomeMorador').value;
      const tipo = document.getElementById('tipoCorrespondencia').value;
      const data = document.getElementById('dataRecebimento').value;

      entregas.push({ nome, tipo, data });
      salvarDados("entregas", entregas);

      atualizarTabela();
      formCorrespondencia.reset();
      alert("Correspondência registrada com sucesso!");
    });

    // ---------- Cadastro de moradores ----------
    const formMorador = document.getElementById('form-morador');
    const listaMoradores = document.getElementById('lista-moradores');
    let moradores = carregarDados("moradores");

    function atualizarMoradores() {
      listaMoradores.innerHTML = "";
      moradores.forEach((m, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
          ${m.nome} - Ap: ${m.apto}
          <button class="btn-excluir" onclick="excluirMorador(${index})">Excluir</button>
        `;
        listaMoradores.appendChild(li);
      });
    }

    function excluirMorador(index) {
      if (confirm("Deseja realmente excluir este morador?")) {
        moradores.splice(index, 1);
        salvarDados("moradores", moradores);
        atualizarMoradores();
      }
    }

    atualizarMoradores();

    formMorador.addEventListener('submit', function(e) {
      e.preventDefault();
      const nome = document.getElementById('novoMorador').value;
      const apto = document.getElementById('apartamento').value;

      moradores.push({ nome, apto });
      salvarDados("moradores", moradores);

      atualizarMoradores();
      formMorador.reset();
      alert("Morador cadastrado com sucesso!");
    });
  </script>
</body>
</html>
