<!DOCTYPE html>
<html lang="pt-BR">
<!-- ... todo o HTML original acima permanece igual ... -->

<script>
    // Sistema de persistência usando localStorage
    class DatabaseManager {
        constructor() {
            this.initializeData();
        }
        initializeData() {
            if (!localStorage.getItem('moradores')) localStorage.setItem('moradores', JSON.stringify([]));
            if (!localStorage.getItem('correspondencias')) localStorage.setItem('correspondencias', JSON.stringify([]));
        }
        getMoradores() { return JSON.parse(localStorage.getItem('moradores') || '[]'); }
        saveMoradores(m) { localStorage.setItem('moradores', JSON.stringify(m)); }
        getCorrespondencias() { return JSON.parse(localStorage.getItem('correspondencias') || '[]'); }
        saveCorrespondencias(c) { localStorage.setItem('correspondencias', JSON.stringify(c)); }
    }

    const db = new DatabaseManager();
    let moradores = db.getMoradores();
    let correspondencias = db.getCorrespondencias();

    // ATUALIZAÇÃO DASHBOARD
    function updateDashboard() {
        moradores = db.getMoradores();
        correspondencias = db.getCorrespondencias();
        document.getElementById('totalMoradores').textContent = moradores.length;
        document.getElementById('totalCorrespondencias').textContent = correspondencias.length;
        document.getElementById('pendentes').textContent = correspondencias.filter(c => c.status === 'Pendente').length;
        document.getElementById('entregues').textContent = correspondencias.filter(c => c.status === 'Entregue').length;
    }

    function atualizarDashboardInstantaneo() {
        document.getElementById('totalMoradores').textContent = moradores.length;
        document.getElementById('totalCorrespondencias').textContent = correspondencias.length;
        document.getElementById('pendentes').textContent = correspondencias.filter(c => c.status === 'Pendente').length;
        document.getElementById('entregues').textContent = correspondencias.filter(c => c.status === 'Entregue').length;
    }

    // EXCLUIR MORADOR
    function excluirMorador(id) {
        id = Number(id);
        if (confirm('Tem certeza que deseja excluir este morador?')) {
            moradores = moradores.filter(m => Number(m.id) !== id);
            db.saveMoradores(moradores);
            document.querySelector('#tabelaMoradores tbody').innerHTML = '';
            renderTabelaMoradores();
            updateDashboard();
            showToast('Morador excluído com sucesso!', 'success');
            atualizarDashboardInstantaneo();
        }
    }

    // EXCLUIR CORRESPONDÊNCIA
    function excluirCorrespondencia(id) {
        id = Number(id);
        if (confirm('Tem certeza que deseja excluir esta correspondência?')) {
            correspondencias = correspondencias.filter(c => Number(c.id) !== id);
            db.saveCorrespondencias(correspondencias);
            document.querySelector('#tabelaCorrespondencias tbody').innerHTML = '';
            document.querySelector('#tabelaEntregues tbody').innerHTML = '';
            renderTabelaCorrespondenciasPendentes();
            renderTabelaCorrespondenciasEntregues();
            updateDashboard();
            showToast('Correspondência excluída com sucesso!', 'success');
            atualizarDashboardInstantaneo();
        }
    }
</script>
</html>